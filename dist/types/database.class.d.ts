import Resource from './resource.class.js';
import { ProcessManager } from './concerns/process-manager.js';
import { SafeEventEmitter } from './concerns/safe-event-emitter.js';
import { CronManager } from './concerns/cron-manager.js';
import { type Logger } from './concerns/logger.js';
import { type CreateResourceConfig, type HashExistsResult } from './database/database-resources.class.js';
import type { Client } from './clients/types.js';
import type { BehaviorType } from './behaviors/types.js';
import type { LogLevel, StringRecord } from './types/common.types.js';
import type { ResourceExport } from './resource.class.js';
import type { PartitionsConfig } from './core/resource-query.class.js';
import type { AttributesSchema } from './core/resource-validator.class.js';
import type { ExecutorPoolConfig, AutotuneConfig, MonitoringConfig, TaskExecutorMonitoringConfig, LoggerConfig, ClientOptions, CacheConfig, SavedMetadata, ResourceMetadata, VersionData, HookSummary, DefinitionChange, GlobalCoordinatorOptions, GlobalCoordinatorService, MemorySnapshot, HookEventName, DatabaseHookFunction, Plugin, PluginConstructor } from './database/types.js';
export type { ExecutorPoolConfig, AutotuneConfig, MonitoringConfig, TaskExecutorMonitoringConfig, LoggerConfig, ClientOptions, CacheConfig, SavedMetadata, ResourceMetadata, VersionData, HookSummary, DefinitionChange, GlobalCoordinatorOptions, GlobalCoordinatorService, MemorySnapshot, HookEventName, DatabaseHookFunction, Plugin, PluginConstructor, CreateResourceConfig, HashExistsResult };
export type { ResourceApiConfig } from './database/database-resources.class.js';
export interface DatabaseOptions {
    connectionString?: string;
    bucket?: string;
    region?: string;
    accessKeyId?: string;
    secretAccessKey?: string;
    endpoint?: string;
    forcePathStyle?: boolean;
    client?: Client;
    clientOptions?: ClientOptions;
    plugins?: PluginConstructor[];
    cache?: CacheConfig | boolean;
    passphrase?: string;
    bcryptRounds?: number;
    versioningEnabled?: boolean;
    strictValidation?: boolean;
    strictHooks?: boolean;
    disableResourceEvents?: boolean;
    deferMetadataWrites?: boolean;
    metadataWriteDelay?: number;
    parallelism?: number | string;
    executorPool?: ExecutorPoolConfig | false;
    operationsPool?: ExecutorPoolConfig | false;
    taskExecutorMonitoring?: TaskExecutorMonitoringConfig;
    logLevel?: LogLevel;
    loggerOptions?: LoggerConfig;
    logger?: Logger;
    processManager?: ProcessManager;
    cronManager?: CronManager;
    exitOnSignal?: boolean;
    autoCleanup?: boolean;
}
export declare class Database extends SafeEventEmitter {
    id: string;
    version: string;
    s3dbVersion: string;
    resources: StringRecord<Resource>;
    savedMetadata: SavedMetadata | null;
    databaseOptions: DatabaseOptions;
    executorPool: ExecutorPoolConfig;
    taskExecutor: ExecutorPoolConfig;
    pluginList: PluginConstructor[];
    pluginRegistry: StringRecord<Plugin>;
    plugins: StringRecord<Plugin>;
    cache: CacheConfig | boolean | undefined;
    passphrase: string;
    bcryptRounds: number;
    versioningEnabled: boolean;
    strictValidation: boolean;
    strictHooks: boolean;
    disableResourceEvents: boolean;
    deferMetadataWrites: boolean;
    metadataWriteDelay: number;
    processManager: ProcessManager;
    cronManager: CronManager;
    logLevel: string;
    logger: Logger;
    client: Client;
    connectionString: string | undefined;
    bucket: string;
    keyPrefix: string;
    _resourcesMap: StringRecord<Resource>;
    private _parallelism;
    private _childLoggerLevels;
    private _hooksModule;
    private _coordinatorsModule;
    private _recoveryModule;
    private _metadataModule;
    private _pluginsModule;
    private _resourcesModule;
    private _connectionModule;
    constructor(options: DatabaseOptions);
    private _initializeClient;
    get parallelism(): number;
    set parallelism(value: number | string);
    setConcurrency(value: number | string): void;
    get operationsPool(): ExecutorPoolConfig;
    get config(): {
        version: string;
        s3dbVersion: string;
        bucket: string;
        keyPrefix: string;
        taskExecutor: ExecutorPoolConfig;
        logLevel: string;
    };
    getChildLogger(name: string, bindings?: Record<string, unknown>): Logger;
    setChildLevel(name: string, level: LogLevel): void;
    connect(): Promise<void>;
    disconnect(): Promise<void>;
    isConnected(): boolean;
    startPlugins(): Promise<void>;
    usePlugin(plugin: Plugin, name?: string | null): Promise<Plugin>;
    uninstallPlugin(name: string, options?: {
        purgeData?: boolean;
    }): Promise<void>;
    getGlobalCoordinator(namespace: string, options?: GlobalCoordinatorOptions): Promise<GlobalCoordinatorService>;
    createResource(config: CreateResourceConfig): Promise<Resource>;
    listResources(): Promise<ResourceExport[]>;
    getResource(name: string): Promise<Resource>;
    resourceExists(name: string): boolean;
    resourceExistsWithSameHash(params: {
        name: string;
        attributes: AttributesSchema;
        behavior?: BehaviorType;
        partitions?: PartitionsConfig;
    }): HashExistsResult;
    uploadMetadataFile(): Promise<void>;
    flushMetadata(): Promise<void>;
    blankMetadataStructure(): SavedMetadata;
    detectDefinitionChanges(savedMetadata: SavedMetadata): DefinitionChange[];
    generateDefinitionHash(definition: ResourceExport, behavior?: BehaviorType): string;
    getNextVersion(versions?: StringRecord<VersionData>): string;
    addHook(event: HookEventName, fn: DatabaseHookFunction): void;
    removeHook(event: HookEventName, fn: DatabaseHookFunction): void;
    getHooks(event: HookEventName): DatabaseHookFunction[];
    clearHooks(event: HookEventName): void;
    private _deepMerge;
    private _applyTaskExecutorMonitoring;
    private _normalizeParallelism;
    private _normalizeOperationsPool;
    private _inferConnectionStringFromClient;
}
export declare class S3db extends Database {
}
export default S3db;
//# sourceMappingURL=database.class.d.ts.map